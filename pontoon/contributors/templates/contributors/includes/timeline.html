{% macro render_contribution_group(title, contribution_type, entries) %}
<div class="contribution-group">
    <h4 class="heading">
        <span class="icon far {{ contribution_type }}"></span>
        {{ title }}
    </h4>
    <ul class="localizations">
        {% for localization in entries %}
        <li>
            <a href="{{ localization.url }}">
                <span class="stress">{{ localization.project.name }}</span> &middot;
                {{ localization.locale.name }} <span class="stress">{{ localization.locale.code }}</span>
                
                {% if contribution_timeline.show_year %}
                    <span class="contribution-count">{{ ", ".join(localization.actions) }}</span>
                {% else %}
                    <span class="contribution-count">{{ ", ".join(localization.action_dates) }}</span>
                {% endif %}

            </a>
        </li>
        {% endfor %}
    </ul>
</div>
{% endmacro %}

<h3>{{ contribution_timeline.title }}</h3>

{% if contribution_timeline.show_year %}

    {% for month, contribution_types in contribution_timeline.contributions.items() %}
    <div class="month-group">
        <h4>{{ month }}</h4>
        {% for contribution_type, details in contribution_types.items() %}
            {{ render_contribution_group(details.title, contribution_type, details.entries) }}
        {% endfor %}
    </div>
    {% endfor %}

{% else %}

    {% for title, project_data in contribution_timeline.contributions.items() %}
        {{ render_contribution_group(title, project_data.type, project_data.data.values() | list) }}
    {% endfor %}

{% endif %}

{% if contribution_timeline.contributions == {} %}
<p>No activity in this period.</p>
{% else %}
{% for title, details in contribution_timeline.contributions.items() %}
<h4 class="heading">
    <span class="icon far {{ details.type }}"></span>
    {{ title }}
</h4>
<ul class="localizations">
    {% for project, project_details in details.data.items() %}

    <li>
        <a href="{{ project_details.url }}">
            <span class="stress">{{ project_details.project.name }}</span>
            &middot; {{ project_details.locale.name }} <span class="stress">{{ project_details.locale.code }}</span>
            <p><strong>Actions:</strong></p>
            <ul>
                {% for index in range(project_details.actions | length) %}
                <li>{{ project_details.actions[index] }} &middot; {{ project_details.date_created[index] }}</li>
                {% endfor %}
            </ul>
        </a>
    </li>

    {% endfor %}
</ul>

{% endfor %}
{% endif %}