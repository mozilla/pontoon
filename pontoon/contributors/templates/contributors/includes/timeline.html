{% macro render_contribution_group(title, contribution_type, entries) %}
<div class="contribution-group">
    <h4 class="heading">
        <span class="icon far {{ contribution_type }}"></span>
        {{ title }}
    </h4>
    <ul class="localizations">
        {% for localization in entries %}
        <li>
            <a href="{{ localization.url }}">
                <span class="stress">{{ localization.project.name }}</span> &middot;
                {{ localization.locale.name }} <span class="stress">{{ localization.locale.code }}</span>
                
                {% if contribution_timeline.show_year %}
                    <span class="contribution-count">{{ ", ".join(localization.actions) }}</span>
                {% else %}
                    <span class="contribution-count">{{ ", ".join(localization.action_dates) }}</span>
                {% endif %}

            </a>
        </li>
        {% endfor %}
    </ul>
</div>
{% endmacro %}

<h3>{{ contribution_timeline.title }}</h3>

{% if contribution_timeline.show_year %}

    {% for month, contribution_types in contribution_timeline.contributions.items() %}
    <div class="month-group">
        <h4>{{ month }}</h4>
        {% for contribution_type, details in contribution_types.items() %}
            {{ render_contribution_group(details.title, contribution_type, details.entries) }}
        {% endfor %}
    </div>
    {% endfor %}

{% else %}

    {% for title, project_data in contribution_timeline.contributions.items() %}
        {{ render_contribution_group(title, project_data.type, project_data.data.values() | list) }}
    {% endfor %}

{% endif %}

{% if contribution_timeline.contributions == {} %}
<p>No activity in this period.</p>
{% else %}
    {% for activity, details in contribution_timeline.contributions.items() %}
        <h4>{{ activity }}</h4>
        {% for project, project_details in details.data.items() %}
            <p><strong>Project Name:</strong> {{ project_details.project.name }}</p>
            <p><strong>Locale:</strong> {{ project_details.locale.name }} ({{ project_details.locale.code }})</p>
            <p><strong>Actions:</strong></p>
            <ul>
                {% for action in project_details.actions %}
                    <li>{{ action }}</li>
                {% endfor %}
            </ul>
            <p><strong>Count:</strong> {{ project_details.count }}</p>
            <p><strong>Dates:</strong></p>
            <ul>
                {% for date in project_details.date_created %}
                    <li>{{ date }}</li>
                {% endfor %}
            </ul>
            <p><strong>URL:</strong> <a href="{{ project_details.url }}">{{ project_details.url }}</a></p>
        {% endfor %}
    {% endfor %}
{% endif %}
